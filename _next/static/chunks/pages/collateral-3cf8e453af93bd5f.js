(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[653],{41961:function(e,l,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/collateral",function(){return a(86086)}])},47297:function(e,l,a){"use strict";var r=a(85893);a(67294);var t=a(33096),i=a(58091),o=a(46986),n=a(46558);let s=e=>{let{items:l,children:a}=e,{account:s}=(0,n.Z)();return(0,r.jsx)(t.Z,{display:"flex",flexDirection:"column",gap:"1rem",children:(0,r.jsx)(t.Z,{display:"flex",bgColor:"#181915",width:{base:"100%",lg:"min"},height:"100%",maxHeight:{base:"150px"},marginInline:"auto",borderRadius:{base:"12px",lg:"31px"},flexDirection:{base:"column",lg:"row"},alignItems:{base:"flex-start",lg:"center"},justifyContent:"space-between",padding:{base:"1.2rem 1.2rem",lg:"1.2rem 2rem"},sx:{"& > *":{whiteSpace:"nowrap"}},gap:{base:"0.5rem",lg:"5rem"},children:l&&l.map((e,l)=>{let{loading:a,data:n,customColor:d}=e.value;return(0,r.jsxs)(t.Z,{display:"inline-flex",alignItems:"center",gap:"0.5rem",children:[(0,r.jsxs)(i.Z,{variant:"banner-sub-label",children:[e.label,":"]}),a?(0,r.jsx)(o.Z,{width:"50px"}):(0,r.jsx)(i.Z,{variant:"banner-sub-desc",color:null!=d?d:void 0,children:n&&s?n:"--"})]},"".concat(l,"-").concat(e.label))})})})};l.Z=s},87303:function(e,l,a){"use strict";var r=a(85893);a(67294);var t=a(20526),i=a(58091),o=a(48641);let n=e=>{let{asset:l,value:a}=e;return(0,r.jsxs)(o.kC,{gap:"0.4rem",alignItems:"center",children:[(0,r.jsx)(t.Z,{token:l,minW:"21px",imageCustomStyle:{boxSize:"20px"},justifyContent:"center"})," ",(0,r.jsxs)(i.Z,{transform:"translateY(0.1rem)",children:[a,"%"]})]})};l.Z=n},57919:function(e,l,a){"use strict";a.d(l,{Bb:function(){return d},Fq:function(){return n},KX:function(){return i},fu:function(){return s},mW:function(){return o},pK:function(){return v},wG:function(){return u}}),a(23732);var r=a(34332),t=a(88767);let i=()=>{let{stats:e}=(0,r.Z)();return(0,t.useQuery)(["global-query"],()=>{if(!e.isSuccess)throw Error("Initializing global stats error");return e.data.global},{enabled:Boolean(void 0!==e.data)})},o=e=>{let{stats:l}=(0,r.Z)();return(0,t.useQuery)(["tokenStats",e],()=>{if(!l.isSuccess)throw Error("No stats");if(""===e)throw Error("No token");let a=l.data.assets[e];if(!a)throw Error("tokenStats not found for ".concat(e));return a},{enabled:Boolean(l.isSuccess&&""!==e)})},n=e=>{let{stats:l}=(0,r.Z)();return(0,t.useQuery)(["price-stats",JSON.stringify(l)],async()=>{if(!l.isSuccess)throw Error("No stats");if(!e)throw Error("No asset name");return l.data.assets[e].price},{enabled:Boolean(l.isSuccess&&void 0!==e)})},s=()=>{let{config:e,stats:l}=(0,r.Z)(),a=null==e?void 0:e.getAssets();return(0,t.useQuery)(["multi-price-stats",JSON.stringify(a),JSON.stringify(l.data)],async()=>{if(!a)throw Error("No config found");if(!l.isSuccess)throw Error("No stats found");let e={};for(let[r,t]of Object.entries(l.data.assets)){var i;e={...e,[null==a?void 0:null===(i=a[r])||void 0===i?void 0:i.address]:t.price}}return e},{enabled:Boolean(a&&l.isSuccess),staleTime:12e4,refetchOnWindowFocus:!1,refetchOnMount:!1})},d=()=>{let{stats:e}=(0,r.Z)();return(0,t.useQuery)(["collaterals-stats"],()=>{if(!e.isSuccess)throw Error("Initializing collateral stats error");let l={},{assets:a}=e.data;return Object.entries(a).forEach(e=>{let[a,r]=e,{collateral:t,price:i,assetConfig:o}=r;"collateral"in r&&(l={...l,[a]:{collateral:t,price:i,assetConfig:o}})}),l},{enabled:Boolean(void 0!==e.data)})},u=()=>{let{stats:e}=(0,r.Z)();return(0,t.useQuery)(["reserves-stats"],()=>{if(!e.isSuccess)throw Error("Initializing reserves stats error");let l={},{assets:a}=e.data;return Object.entries(a).forEach(e=>{let[a,r]=e,{reserve:t,price:i,assetConfig:o}=r;"reserve"in r&&(l={...l,[a]:{reserve:t,price:i,assetConfig:o}})}),l},{enabled:Boolean(void 0!==e.data)})},v=e=>{let{stats:l}=(0,r.Z)();return(0,t.useQuery)(["collateral-rewards-stats",e],async()=>{var a,r,t,i,o;if(!l.isSuccess)throw Error("collateral rewards ".concat(e," stats issue: main stats error"));let{assets:n}=l.data;return null!==(o=null!==(i=null===(a=n[e].collateral.AAVE)||void 0===a?void 0:a.rewards)&&void 0!==i?i:null===(r=n[e].collateral.Convex)||void 0===r?void 0:r.rewards)&&void 0!==o?o:null===(t=n[e].collateral.Stargate)||void 0===t?void 0:t.rewards},{enabled:Boolean(void 0!==l.data&&l.isSuccess)})}},7629:function(e,l,a){"use strict";a.d(l,{cu:function(){return d},Ct:function(){return s}});var r=a(88767),t=a(64146),i=a(56371),o=a(46558);a(23732),a(42974),a(96486);var n=a(34332);let s=e=>{let{config:l}=(0,n.Z)(),{account:a,provider:s,chainId:d}=(0,o.Z)();return(0,r.useQuery)(["use-token-balances-query",a,e],async()=>{if(!s)throw Error("No provider");if(!a)throw Error("No account");if(!l)throw Error("No config");if(!d)throw Error("Couldn't fetch chain ID");let r=l.getAsset(e),o=new t.CH(r.address,r.abi,s),n=await o.balanceOf(a);return(0,i.formatUnits)(n,r.decimals)},{staleTime:3e4,cacheTime:6e4,refetchOnMount:"always",enabled:Boolean(l&&""!==e&&a),retry:3,retryDelay:e=>1e3*e,onError(e){console.error(e)}})},d=e=>{let{multiLedger:l}=(0,n.Z)(),{account:a}=(0,o.Z)();return(0,r.useQuery)(["token-balances-new","".concat(a,"-").concat(JSON.stringify(e))],async()=>{if(!l)throw Error("Error: Multiledger not initialized");if(!a)throw Error("Error: User not logged in");if(!e)throw Error("Balance Error: no list of tokens found");let r=await l.balanceOf(e);return Object.entries(r).map(e=>{let[,l]=e;return l})},{enabled:Boolean(l&&""!==a&&!!e),retry:3,keepPreviousData:!0})}},86086:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return B}});var r,t,i=a(85893),o=a(67294),n=a(11163),s=a(9008),d=a.n(s),u=a(33096),v=a(93330),c=a(6937),m=a(53818),g=a(46558),p=a(66319),f=a(7629),h=a(66260),b=a(57919),y=a(47297),w=a(3588),x=a(56371),E=a(76585),S=a(34332),N=a(88767),Z=a(43382),A=a(41636);(r=t||(t={}))[r.displayAsset=0]="displayAsset",r[r.tvl=1]="tvl",r[r.ltvRatio=2]="ltvRatio",r[r.apr=3]="apr",r[r.depositedAmt=4]="depositedAmt",r[r.depositedUsd=5]="depositedUsd",r[r.balance=6]="balance",r[r.reinvestments=7]="reinvestments",r[r.rewards=8]="rewards",r[r.underlyingAssets=9]="underlyingAssets";var j=a(87303),C=a(96486);let L=()=>{let[e,l]=o.useState([]),{push:a}=(0,n.useRouter)(),{config:r}=(0,S.Z)(),{leverageUsed:s}=(0,Z.Z)(),{account:L,isConnected:B,impersonatedAccount:O}=(0,g.Z)(),{isDesktopView:F}=(0,c.Z)(),R=null==r?void 0:r.getCollaterals(),k=(0,w.Z)(),U=(0,E.Z)(),I=(0,f.cu)(void 0!==R?Object.values(R).map(e=>e.address):void 0),_=(0,b.Bb)(),T=(0,N.useQuery)(["display-collateral"],async()=>null==r?void 0:r.getCollaterals(),{staleTime:1/0}),Q=(0,p.cA)(),D=o.useMemo(()=>{if(void 0===R||!_.isSuccess)return[];let l=[],a=0;for(let[r,i]of Object.entries(R)){var o,n,s,d,u,v,c,m,g,p,f,h,b,y,w,E,S,N;let Z=null!==(p=A.ReinvestmentPlatformVariables.find(e=>void 0!==i.reinvestments[e]))&&void 0!==p?p:"None",j=r.includes("CurveLP")?null==r?void 0:r.replace("CurveLP_",""):r;l.push({asset:r,displayAsset:j,reinvestment:null!==(f=null===(o=null===(n=R[r])||void 0===n?void 0:n.reinvestments[Z])||void 0===o?void 0:o.address)&&void 0!==f?f:"0x0000000000000000000000000000000000000000",reinvestmentName:Z,underlyingAssets:JSON.stringify(i.underlyingAssets),rewards:{loading:_.isLoading,error:_.isError,data:JSON.stringify(null===(s=_.data[r])||void 0===s?void 0:s.collateral[Z].rewards)},ltvRatio:{loading:_.isLoading,error:_.isError,data:null!==(h=((null===(d=_.data[r])||void 0===d?void 0:d.collateral[Z].collateralData.configuration.ltvGwei)*100).toFixed(1))&&void 0!==h?h:""},apr:{loading:_.isLoading,error:_.isError,data:null!==(b=null===(u=_.data[r])||void 0===u?void 0:u.collateral[Z].apr.toString())&&void 0!==b?b:""},tvl:{loading:_.isLoading,error:_.isError,data:null!==(y=null===(v=_.data[r])||void 0===v?void 0:v.collateral[Z].tvl.toString())&&void 0!==y?y:""},depositedAmt:{loading:Boolean(Q.isLoading&&L),error:Q.isError,data:Q.isSuccess?null!==(E=(0,x.formatUnits)(null!==(w=null===(c=Q.data[i.address])||void 0===c?void 0:c.collateral)&&void 0!==w?w:(0,x.parseUnits)("0",i.decimals),i.decimals))&&void 0!==E?E:"":"0"},depositedUsd:{loading:Boolean(Q.isLoading&&L),error:Q.isError||_.isError,data:Q.isSuccess?(parseFloat(null!==(N=(0,x.formatUnits)(null!==(S=null===(m=Q.data[i.address])||void 0===m?void 0:m.collateral)&&void 0!==S?S:(0,x.parseUnits)("0",i.decimals),i.decimals))&&void 0!==N?N:"")*(null===(g=_.data[r])||void 0===g?void 0:g.price)).toString():"0"},balance:{loading:Boolean(I.isLoading&&L),error:I.isError,data:I.isSuccess?(0,x.formatUnits)(I.data[a],i.decimals):"0"}}),a+=1}return l.sort((l,a)=>{var r,i,o,n;let s=t[e.findIndex(e=>e>0)];return"displayAsset"===s?1===e[e.findIndex(e=>e>0)]?l.displayAsset.toLowerCase()>a.displayAsset.toLowerCase()?1:-1:2===e[0]?l.displayAsset.toLowerCase()<a.displayAsset.toLowerCase()?1:-1:0:1===e[e.findIndex(e=>e>0)]?parseFloat(null===(r=l[s])||void 0===r?void 0:r.data)<parseFloat(null===(i=a[s])||void 0===i?void 0:i.data)?1:-1:2===e[e.findIndex(e=>e>0)]?parseFloat(null===(o=l[s])||void 0===o?void 0:o.data)>parseFloat(null===(n=a[s])||void 0===n?void 0:n.data)?1:-1:0})},[R,_,Q,I,L,B,O]);return(0,i.jsxs)("div",{children:[(0,i.jsxs)(d(),{children:[(0,i.jsx)("title",{children:"Collateral | LeverFi"}),(0,i.jsx)("meta",{name:"description",content:"Margin Trade with 10x Leverage using Yield Bearing Assets"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsxs)(v.Z,{pageTitle:"Collateral",children:[(0,i.jsx)(u.Z,{marginBottom:"40px",children:(0,i.jsx)(y.Z,{items:[{label:"Collateral Liquidity",value:{loading:Boolean(k.isLoading),data:k.isSuccess&&L?(0,h.ld)((0,x.formatEther)(k.data[0]),!0):"--"}},{label:"Leverage Liquidity",value:{loading:Boolean(k.isLoading),data:k.isSuccess&&L?(0,h.ld)((0,x.formatEther)(k.data[6]),!0):"--"}},{label:"Leverage Used",value:{loading:Boolean(s.isLoading),data:s.isSuccess&&L?"".concat(parseFloat(s.data).toFixed(1),"x"):"--",customColor:s.isSuccess&&U.isSuccess&&parseFloat(s.data)>=5?"red":"lever.main"}}]})}),(0,i.jsx)(u.Z,{children:(0,i.jsx)(m.Z,{setSortStatus:l,query:T,headItems:[{name:"Asset"},{name:"TVL",alignment:!0},{name:"LTV Ratio",alignment:!0},{name:"APR",alignment:!0},{name:"Deposited Amt",alignment:!0},{name:"Deposited Value",alignment:!0},{name:"Wallet Balance",alignment:!0}],acceptNotConnected:!0,placeholderCustom:"There is something wrong with loading assets, please refresh and try again.",rows:D.map((e,l)=>{var r,t,o,n,s,d,u,v,c,m,g,p,f,b,y,w,E,S,N,Z,A,B,O,F,R,k,U,I,T,Q,D,q,J,P,M,z,V,W,X,$;let G=(null==e?void 0:null===(r=e.rewards)||void 0===r?void 0:r.data)?JSON.parse(null==e?void 0:null===(t=e.rewards)||void 0===t?void 0:t.data):{},H=null===(o=null==_?void 0:null===(n=_.data)||void 0===n?void 0:null===(s=n[null==e?void 0:e.asset])||void 0===s?void 0:s.collateral[null==e?void 0:e.reinvestmentName])||void 0===o?void 0:o.aprBreakdown;return{id:"".concat(e.asset,"-").concat(l,"-").concat(L),items:[{isMainColumn:!0,loading:Boolean(!e.displayAsset),data:e.displayAsset,error:void 0==e.displayAsset,underlyingAssets:null==e?void 0:e.underlyingAssets},{loading:null==e?void 0:null===(d=e.tvl)||void 0===d?void 0:d.loading,data:"$".concat((null==e?void 0:null===(u=e.tvl)||void 0===u?void 0:u.error)?"0.0":null!==(J=(0,x.commify)((0,h.wp)(null!==(q=null==e?void 0:null===(v=e.tvl)||void 0===v?void 0:v.data)&&void 0!==q?q:0)))&&void 0!==J?J:"--"),isNumeric:!0},{loading:null==e?void 0:null===(c=e.ltvRatio)||void 0===c?void 0:c.loading,data:"".concat((null==e?void 0:null===(m=e.ltvRatio)||void 0===m?void 0:m.error)?"0.0":null!==(M=Number(null!==(P=null==e?void 0:null===(g=e.ltvRatio)||void 0===g?void 0:g.data)&&void 0!==P?P:"0").toFixed(1))&&void 0!==M?M:"--","%"),isNumeric:!0},{loading:null==e?void 0:null===(p=e.apr)||void 0===p?void 0:p.loading,data:"".concat((null==e?void 0:null===(f=e.apr)||void 0===f?void 0:f.error)?"0":isNaN(Number(null==e?void 0:null===(b=e.apr)||void 0===b?void 0:b.data))?"0":Number(null==e?void 0:null===(y=e.apr)||void 0===y?void 0:y.data).toFixed(2),"%"),error:null==e?void 0:null===(w=e.apr)||void 0===w?void 0:w.error,isNumeric:!0,hoverElement:(null==e?void 0:null===(E=e.rewards)||void 0===E?void 0:E.data)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.Z,{asset:null==e?void 0:e.displayAsset,value:H?null===(N=Object.values(H).map(e=>e))||void 0===N?void 0:N[0].toFixed(2):parseFloat(null!==(V=null==e?void 0:null===(Z=e.apr)||void 0===Z?void 0:Z.data)&&void 0!==V?V:"0").toFixed(2)}),(null==e?void 0:e.reinvestmentName)=="Convex"&&Object.entries(G).map((e,l)=>{var a;let[r,t]=e;return(0,i.jsx)(j.Z,{asset:null==t?void 0:t.asset,value:null===(a=Object.values(H).map(e=>e))||void 0===a?void 0:a[l+1].toFixed(2)},"".concat(r,"-").concat(l))})]}):(0,i.jsx)(j.Z,{asset:null==e?void 0:e.asset,value:parseFloat(null!==(z=null==e?void 0:null===(S=e.apr)||void 0===S?void 0:S.data)&&void 0!==z?z:"").toFixed(2)})},{loading:!!(null==e?void 0:null===(A=e.depositedAmt)||void 0===A?void 0:A.loading),data:(null==e?void 0:null===(B=e.depositedAmt)||void 0===B?void 0:B.error)||!L?"0":(0,h.RR)(null!==(W=null==e?void 0:null===(O=e.depositedAmt)||void 0===O?void 0:O.data)&&void 0!==W?W:"1"),error:null==e?void 0:null===(F=e.depositedAmt)||void 0===F?void 0:F.error,isNumeric:!0},{loading:!!(null==e?void 0:null===(R=e.depositedUsd)||void 0===R?void 0:R.loading),data:(null==e?void 0:null===(k=e.depositedUsd)||void 0===k?void 0:k.error)||!L?"$0":"$".concat((0,C.floor)(null!==(X=Number(null==e?void 0:null===(U=e.depositedUsd)||void 0===U?void 0:U.data))&&void 0!==X?X:0,0).toLocaleString()),error:null==e?void 0:null===(I=e.depositedUsd)||void 0===I?void 0:I.error,isNumeric:!0},{loading:!!(null==e?void 0:null===(T=e.balance)||void 0===T?void 0:T.loading),data:!L||(null==e?void 0:null===(Q=e.balance)||void 0===Q?void 0:Q.error)?"0":(0,h.RR)(null!==($=null==e?void 0:null===(D=e.balance)||void 0===D?void 0:D.data)&&void 0!==$?$:"0"),isNumeric:!0}],pushRouter(){L&&a({pathname:"/collateral/".concat(e.displayAsset),query:{reinvestment:null==e?void 0:e.reinvestment,fullName:null==e?void 0:e.asset}})}}})})})]})]})};var B=L}},function(e){e.O(0,[787,828,774,888,179],function(){return e(e.s=41961)}),_N_E=e.O()}]);